# Nome do Workflow
name: 游 Deploy Suzi Artesanatos para Fly.io

# Define quando este workflow ser치 executado (ao fazer push na branch 'main')
on:
  push:
    branches: ["main"]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # 1. Puxa o c칩digo do reposit칩rio (Necess치rio para acessar fly.toml e Dockerfile)
      - name: 游닍 Checkout do Reposit칩rio
        uses: actions/checkout@v4
        
      # 2. Build e Deploy para o Fly.io usando a Action oficial
      - name: 游 Fazer Deploy no Fly.io
        uses: superfly/flyctl-actions/deploy@master
        with:
          # Argumento crucial: For칞a o uso do seu Dockerfile, contornando a falha de 'launch manifest'.
          args: deploy --dockerfile ./Dockerfile 
        env:
          # Autentica칞칚o no Fly.io (Obrigat칩rio)
          FLY_API_TOKEN: ${{ secrets.FLY_API_TOKEN }} 
          
          # Vari치veis de Ambiente injetadas na sua aplica칞칚o Next.js
          ADMIN_USER: ${{ secrets.ADMIN_USER }}
          ADMIN_PASS: ${{ secrets.ADMIN_PASS }}
